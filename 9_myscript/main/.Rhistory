main_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/1_data"
config_dir <- file.path(main_dir, "9_myscript/Rscript/config")
source(file.path(config_dir, "config.R"))
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
main_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/1_data"
config_dir <- file.path(main_dir, "9_myscript/process_a_emotion/config")
source(file.path(config_dir, "config.R"))
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscriptconfig")
source(file.path(config_dir, "config.R"))
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 1 import data ----
file_name <- file.path(raw_dir, "0908-第3组-S1S2-前测-讨论-A_lzy.xlsx")
df_arousal_1 <- import(file_name)
View(df_arousal_1)
styler:::style_active_file()
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 1 import data ----
file_name <- file.path(raw_dir, "0908-第3组-S1S2-前测-讨论-A_lzy.xlsx")
df_arousal_1 <- import(file_name)
var_names <- c(
"id", "date", "desc", "duration", "type", "source", "offset", "mediaDur",
"fps", "subject", "behavior", "category", "behaviorType", "time",
"mediaFile", "imageIndex", "imagePath", "comment"
)
colnames(df_arousal_1) <- var_names
View(df_arousal_1)
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 1 import data ----
file_name <- file.path(raw_dir, "0908-第3组-S1S2-前测-讨论-A_lzy.xlsx")
df_arou_1 <- import(file_name)
var_names <- c(
"id", "date", "desc", "duration", "type", "source", "offset", "mediaDur",
"fps", "subject", "behavior", "category", "behaviorType", "time",
"mediaFile", "imageIndex", "imagePath", "comment"
)
colnames(df_arou_1) <- var_names
df_arou_1
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 1 import data ----
file_name <- file.path(raw_dir, "0908-第3组-S1S2-前测-讨论-A_lzy.xlsx")
df_arou_1 <- import(file_name)
var_names <- c(
"id", "date", "desc", "duration", "type", "source", "offset", "mediaDur",
"fps", "subject", "behavior", "category", "behaviorType", "time",
"mediaFile", "imageIndex", "imagePath", "comment"
)
colnames(df_arou_1) <- var_names
df_arou_1 <- df_arou_1 %>%
select(id, duration, fps, behavior, time, imageIndex)
View(df_arou_1)
max_img <- 30*df_arou_1$duration
max_img <- 30*df_arou_1$duration[1]
max_img <- ceiling(30*df_arou_1$duration[1])
df_max <- tibble(seq(0, max_img))
View(df_max)
colnames(df_max) <- "imgIdx"
View(df_max)
df_arou_1 <- df_arou_1 %>%
left_join(df_max, by = imgIdx)
df_arou_1 <- df_arou_1 %>%
left_join(df_max, by = "imgIdx")
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 1 import data ----
file_name <- file.path(raw_dir, "0908-第3组-S1S2-前测-讨论-A_lzy.xlsx")
df_arou_1 <- import(file_name)
var_names <- c(
"id", "date", "desc", "duration", "type", "source", "offset", "mediaDur",
"fps", "subject", "behavior", "category", "behaviorType", "time",
"mediaFile", "imgIdx", "imgPath", "comment"
)
colnames(df_arou_1) <- var_names
df_arou_1 <- df_arou_1 %>%
select(id, duration, behavior, time, imgIdx)
max_img <- ceiling(30*df_arou_1$duration[1])
df_max <- tibble(seq(0, max_img))
colnames(df_max) <- "imgIdx"
df_arou_1 <- df_arou_1 %>%
left_join(df_max, by = "imgIdx")
View(df_arou_1)
df_arou_1 <- df_arou_1 %>%
left_join(df_max, by = "imgIdx", all.x = TRUE)
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 1 import data ----
file_name <- file.path(raw_dir, "0908-第3组-S1S2-前测-讨论-A_lzy.xlsx")
df_arou_1 <- import(file_name)
var_names <- c(
"id", "date", "desc", "duration", "type", "source", "offset", "mediaDur",
"fps", "subject", "behavior", "category", "behaviorType", "time",
"mediaFile", "imgIdx", "imgPath", "comment"
)
colnames(df_arou_1) <- var_names
df_arou_r1 <- df_arou_r1 %>%
select(id, duration, behavior, subject, time, imgIdx)
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 1 import data ----
file_name <- file.path(raw_dir, "0908-第3组-S1S2-前测-讨论-A_lzy.xlsx")
df_arou_r1 <- import(file_name)
var_names <- c(
"id", "date", "desc", "duration", "type", "source", "offset", "mediaDur",
"fps", "subject", "behavior", "category", "behaviorType", "time",
"mediaFile", "imgIdx", "imgPath", "comment"
)
colnames(df_arou_r1) <- var_names
df_arou_r1 <- df_arou_r1 %>%
select(id, duration, behavior, subject, time, imgIdx)
View(df_arou_r1)
# 0. Info ----
# Project: annotated data process
# Author: LiuZiyu
# Created date: 2024/11
# Last edited date: 2024/11/12
# This script is for
#   1) import annotated valence and arousal data,
#   2) fill in v and a data,
#   3) calculate rater consistency
# Data source:
# annotated valence and arousal data exported from boris
# 0 program set up ----
rm(list = ls()) # clear work space
root_dir <- "D:/# Library/0 Academic/2_Programs/2_fNIRS/process_a_emotion"
config_dir <- file.path(root_dir, "9_myscript", "config")
source(file.path(config_dir, "config.R"))
# 1 import data ----
file_name <- file.path(raw_dir, "0908-第3组-S1S2-前测-讨论-A_lzy.xlsx")
df_arou_r1 <- import(file_name)
var_names <- c(
"id", "date", "desc", "duration", "type", "source", "offset", "mediaDur",
"fps", "subject", "behavior", "category", "behaviorType", "time",
"mediaFile", "imgIdx", "imgPath", "comment"
)
colnames(df_arou_r1) <- var_names
df_arou_r1 <- df_arou_r1 %>%
select(id, duration, behavior, subject, time, imgIdx)
max_img <- ceiling(30*df_arou_r1$duration[1])
df_max <- tibble(seq(0, max_img))
colnames(df_max) <- "imgIdx"
df_arou_r1_s1 <- df_arou_r1 %>%
filter(subject == "S1")
df_arou_r1_s2 <- df_arou_r1 %>%
filter(subject == "S2")
df_arou_r1_s1 <- df_max %>%
left_join(df_arou_r1_s1, by = "imgIdx")
View(df_arou_r1_s1)
# 插补函数
fill_na <- function(df) {
for (col in colnames(df)) {
if (is.numeric(df[[col]])) {
# 使用 zoo 包的 na.locf() 插补中间的 NA
df[[col]] <- zoo::na.locf(df[[col]], na.rm = FALSE)
# 使用 na.fill() 填补开头和结尾的 NA
df[[col]] <- zoo::na.fill(df[[col]], fill = c("extend"))
}
}
return(df)
}
# 对数据框进行插补
df_filled <- fill_na(df_arou_r1_s1)
View(df_filled)
head(df_arou_r1_s1)
# 插补函数
fill_na <- function(df) {
for (col in colnames(df)) {
# 使用 zoo 包的 na.locf() 插补中间的 NA
df[[col]] <- zoo::na.locf(df[[col]], na.rm = FALSE)
# 使用 na.fill() 填补开头和结尾的 NA
df[[col]] <- zoo::na.fill(df[[col]], fill = c("extend"))
}
return(df)
}
# 对数据框进行插补
df_filled <- fill_na(df_arou_r1_s1)
# 0. Info ----
